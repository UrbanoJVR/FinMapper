{% extends 'shared/centered_card_content_template.html' %}

{% block centered_content %}
    {% from "shared/show_flash_messages.html" import show_flash_messages %}
    {{ show_flash_messages(get_flashed_messages(with_categories=True)) }}

    <form class="form" method="post">
        {{ form.hidden_tag() }}
        <div class="mb-3 mt-3">
            <label class="form-label">{{ _('Transaction Type') }}</label>
            <div class="btn-group w-100" role="group" id="transaction-type-toggle">
                <input type="radio" class="btn-check" name="type" id="type-expense" value="EXPENSE" 
                       {% if form.type.data == 'EXPENSE' or not form.type.data %}checked{% endif %}>
                <label class="btn btn-outline-danger" for="type-expense">
                    <i class="fas fa-arrow-down"></i> {{ _('Expense') }}
                </label>

                <input type="radio" class="btn-check" name="type" id="type-income" value="INCOME"
                       {% if form.type.data == 'INCOME' %}checked{% endif %}>
                <label class="btn btn-outline-success" for="type-income">
                    <i class="fas fa-arrow-up"></i> {{ _('Income') }}
                </label>
            </div>
            {% if form.type.errors %}
                <div class="invalid-feedback d-block">
                    {% for error in form.type.errors %}
                        <span>{{ error }}</span><br>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.date.label(class="form-label") }}
            {{ form.date(class="form-control") }}
            {% if form.date.errors %}
                <div class="invalid-feedback">
                    {% for error in form.date.errors %}
                        <span>{{ error }}</span><br>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.amount.label(class="form-label") }}
            {{ form.amount(class="form-control") }}
            {% if form.amount.errors %}
                <div class="invalid-feedback">
                    {% for error in form.amount.errors %}
                        <span>{{ error }}</span><br>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.concept.label(class="form-label") }}
            {{ form.concept(class="form-control") }}
            {% if form.concept.errors %}
                <div class="invalid-feedback">
                    {% for error in form.concept.errors %}
                        <span>{{ error }}</span><br>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.comments.label(class="form-label") }}
            {{ form.comments(class="form-control") }}
            {% if form.comments.errors %}
                <div class="invalid-feedback">
                    {% for error in form.comments.errors %}
                        <span>{{ error }}</span><br>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.category_id.label(class="form-label") }}
            {{ form.category_id(class="form-select") }}
            {% if form.category_id.errors %}
                <div class="invalid-feedback">
                    {% for error in form.category_id.errors %}
                        <span>{{ error }}</span><br>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            <button type="submit" class="btn btn-primary">{{ _('Save') }}</button>
            <button type="button" onclick="window.history.back();" class="btn btn-outline-primary">{{ _('Return') }}</button>
        </div>
    </form>

    <style>
        #transaction-type-toggle .btn {
            border-radius: 0;
            flex: 1;
        }
        
        #transaction-type-toggle .btn:first-of-type {
            border-top-left-radius: 0.375rem;
            border-bottom-left-radius: 0.375rem;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }
        
        #transaction-type-toggle .btn:last-of-type {
            border-top-right-radius: 0.375rem;
            border-bottom-right-radius: 0.375rem;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }
        
        #transaction-type-toggle .btn-check:checked + .btn-outline-danger {
            background-color: var(--bs-danger);
            border-color: var(--bs-danger);
            color: white;
        }
        
        #transaction-type-toggle .btn-check:checked + .btn-outline-success {
            background-color: var(--bs-success);
            border-color: var(--bs-success);
            color: white;
        }
    </style>
{% endblock %}